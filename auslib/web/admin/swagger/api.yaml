swagger: '2.0'
info:
  version: '1.0'
  title: "Balrog's Admin API"
  termsOfService: "https://wiki.mozilla.org/Balrog"
  license:
    name: "Mozilla Public License 2.0"
    url: "https://www.mozilla.org/en-US/MPL/2.0/"
  contact:
    name: "Mozilla Release Engineering"
    url: "https://github.com/mozilla/balrog"
    email: "release-engineering@lists.mozilla.org"
  description: >
    **Balrog** is the software that runs the server side component of the update
    system used by Firefox and other Mozilla products. It is the successor to *AUS*
    (Application Update Service), which did not scale to our current needs nor allow
    us to adapt to more recent business requirements. Balrog helps us ship updates faster
    and with much more flexibility than we’ve had in the past.
security:
  - basic: []
securityDefinitions:
  basic:
    type: basic
    description: HTTP basic access authentication

# host and scheme can be omitted for a more dynamic association.
# In this case, the host and scheme used to serve the API documentation
# will be used for API calls. For example, if Swagger UI-based documentation is
# hosted at https://api.example.com/apidocs/index.html, “try it out” API calls
# will be directed to https://api.example.com.

#schemes:
#  - http
#  - https
# basePath: "/api"
# host: "localhost:8080"
# Swagger-UI bug : fix TODO week 13

tags:
  - name: "Rules"
    description: "When a request comes in it is matched against Balrog’s rules to find the one that best suits it which points to a release that has the required information to serve an update back to the client"
    externalDocs:
      description: "Find out more about Rules"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#rules"

  - name: "Users"
    description: "Data about Users"
    externalDocs:
      description: "Find out more about users"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#users"

  - name: "CSRF Token"
    description: "Cross-site request forgery Token for preventing execution of unauthorized commands"
    externalDocs:
      description: "Find out more about CSRF-Token"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#csrf-token"

  - name: "Releases"
    description: "To Balrog, a 'release' is data about a related set of builds. This does _not_ match up with the concept of a 'release' being on the 'beta', 'release' or 'esr' channel elsewhere."
    externalDocs:
      description: "Find out more about Releases"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#releases"

  - name: "Required Signoffs"
    description: "Some types of changes to Balrog's database require more than one person to approve them before they can be done. The Required Signoffs tables specify how many signoffs are needed from different Roles for each type of change."
    externalDocs:
      description: "Find out more about Required Signoffs"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#required-signoffs"

  - name: "Scheduled Changes"
    description: "Some tables (Rules, Releases, and Permissions) support having changes to them scheduled in advance. Tables with Scheduled Changes enabled will have additional related tables to store the necessary information about them."
    externalDocs:
      description: "Find out more about Scheduled Changes"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#scheduled-changes"

  - name: "History"
    description: "The rules, releases, permissions, required signoffs, and all associated scheduled changes tables have a corresponding history table that records the time a change was made and who made it"
    externalDocs:
      description: "Find out more about history tables"
      url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#history-tables"

parameters:
  usernameParam:
    name: username
    in: path
    description: unique identifier name of the user
    type: string
    maxLength: 100
    required: true

  usernameQueryParam:
    name: username
    in: query
    description: unique identifier name of the user
    type: string
    minLength: 1
    maxLength: 100
    x-nullable: true
    required: false

  csrfTokenParam:
    name: csrf_token
    in: query
    description: valid csrf token
    type: string
    required: true

  dataVersionParam:
    name: data_version
    in: query
    description: data version of object.
    type: integer
    format: int32
    minimum: 1
    required: true

  columnParam:
    name: column
    in: path
    description: Name of defined column in DB.
    type: string
    maxLength: 50
    required: true

  allSCParam:
    name: all
    in: query
    description: if argument is present in request then response returns all scheduled changes else only returns unfinished changes
    type: string
    x-nullable: true
    required: false

  productRequiredParam:
    name: product
    in: query
    description: Name of the product to filter the rules/releases against.
    type: string
    minLength: 1
    maxLength: 15
    required: true

  roleRequiredParam:
    name: role
    in: query
    description: roles are used when signing off on Scheduled Changes
    type: string
    minLength: 1
    maxLength: 50
    required: true

  channelRequiredParam:
    name: channel
    in: query
    description: The update channel of the application request an update.
    type: string
    minLength: 1
    maxLength: 75
    required: true

  permissionParam:
    name: permission
    in: path
    description: permission name
    type: string
    enum:
      - admin
      - emergency_shutoff
      - rule
      - release
      - release_read_only
      - release_locale
      - required_signoff
      - permission
      - scheduled_change
    maxLength: 50
    required: true

  roleParam:
    name: role
    in: path
    description: user role to grant access to
    type: string
    maxLength: 50
    required: true

  sc_id_param:
    name: sc_id
    in: path
    description: Field value to uniquely identfiy the scheduled change
    type: integer
    minimum: 0
    required: true

  change_id_param:
    name: change_id
    in: path
    description: Unique id to identify the identify the change
    type: integer
    minimum: 0
    required: true

  field_name_param:
    name: field
    in: path
    description: name of DB column whose history is requested
    type: string
    required: true

  change_id_body_param:
    name: object_change_id
    in: body
    description: change_id of the Rule/Release/Scheduled_Change to revert back to
    required: true
    schema:
      allOf:
        - $ref: '#/definitions/CSRFModel'
        - type: object
          required:
            - change_id
          properties:
            change_id:
              type: integer
              description: change_id of the Rule/Release/Scheduled_Change revision to revert to
              minimum: 0
              example: 85142

  sc_signoff_post_body_param:
    name: sc_post_signoffs_body
    in: body
    description: request body for posting a signoff to a scheduled change
    required: true
    schema:
      type: object
      allOf:
        - $ref: '#/definitions/CSRFModel'
        - $ref: '#/definitions/RoleModel'
      required:
        - role

  userPermissionFormDataParam:
    name: user_permission_request_body
    in: body
    description: Request body containing options and data version field values for manipulating user permission values in DB
    required: true
    schema:
      allOf:
        - $ref: '#/definitions/CSRFModel'
        - $ref: '#/definitions/DataVersionModel'
        - $ref: '#/definitions/OptionsJSON'
      # accommodate 'options_as_json' and 'permission' which are duplicate values of 'options'
      # and 'permission path parameter' respectively, getting passed in request body
      # No need to validate the duplicate values again.
      additionalProperties: true

  changedByParam:
    name: changed_by
    in: query
    description: The username who made the requested changes.
    type: string
    x-nullable: true
    required: false

  changeIdParam:
    name: change_id
    in: query
    description: The change_id value to filter hsitory by.
    type: integer
    x-nullable: true
    required: false

  historyDataVersionParam:
    name: data_version
    in: query
    description: data_version field value to filter history by.
    type: integer
    x-nullable: true
    required: false

  timestampFromParam:
    name: timestamp_from
    in: query
    description: timestamp from/above which to filter history.
    type: integer
    x-nullable: true
    required: false

  timestampToParam:
    name: timestamp_to
    in: query
    description: timestamp to/below which history is filtered.
    type: integer
    x-nullable: true
    required: false

responses:
  updateExistingObject:
    description: "successfully updated the existing object and incremented its data_version"
    schema:
      type: object
      required:
        - new_data_version
      properties:
        new_data_version:
          description: "data version of the updated object. Should be greater than 1"
          type: integer
          format: int32
          minimum: 2
          example: 2

  newObjectDataVersion:
    description: "A new object (permission/role/release/signoff) is successfully created and its data version value is always 1"
    schema:
      type: object
      required:
        - new_data_version
      properties:
        new_data_version:
          description: "data version of the new object (permission/role/release/signoff) assigned. Value is always 1"
          type: integer
          format: int32
          minimum: 1
          maximum: 1
          example: 1

  # explicit Response for APIs utilizing changeRelease() method to serve requests
  # Also used in other APIs where data_version might not change after operation.
  # Hence no minLimit: 1 , no maxLimit on new_data_version.
  # Example: when attempting assign an already existing role to a user.
  modifiedDataVersion:
    description: "Created or Updated exisiting object."
    schema:
      type: object
      required:
        - new_data_version
      properties:
        new_data_version:
          description: "data version of the updated or new object"
          type: integer
          format: int32
          minimum: 1
          example: 2

  columnResponse:
    description:  returns all distinct column values from database
    schema:
      type: object
      required:
       - count
      properties:
        count:
          description: count of unique values of column present in DB
          type: integer
          format: int32
          minimum: 0
          example: 1
      # limits the extent of validation of column_key array
      # oneOf isn't supported in swagger 2.0 but will be in 3.0
      # https://github.com/OAI/OpenAPI-Specification/issues/333
      # NOTE: additional key will be the same value as the column given in the URL
      additionalProperties:
        type: array
      maxProperties: 2
      minProperties: 2
    examples:
      application/json:
        count: 5
        data_version: [1,2,3,4,5]

paths:
  /csrf_token:
    get:
      summary: Returns valid csrf_token in response header.
      description: >
        Returns an empty response with a valid CSRF token in the X-CSRF-Token header. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#csrf-token)
      tags:
        - "CSRF Token"
      operationId: auslib.web.admin.views.mapper.csrf_get
      consumes: []
      produces:
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#csrf-token"
        description: Returns an empty response with a valid CSRF token in the X-CSRF-Token header.
      responses:
        '200':
          description: Generate csrf token
          headers:
            X-CSRF-Token:
              description: token
              type: string
          examples:
            text/html: "csrf_token: 1491342563##c4e6fef0b978e6c89af9ff1015e67b9ca7c45d14"

  /rules/history:
    get:
      summary: Returns a list of all histories.
      description: >
        Returns a list of rules history.
      tags:
        - "History Histories Rules"
      operationId: auslib.web.common.history_all.get_rules_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of rules history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
        - name: channel
          in: query
          description: channel stirng for filtering history.
          type: string
          x-nullable: true
          required: false
      responses:
        '200':
          description: Successfully fetched rules history
        '400':
          $ref: '#/responses/invalidFormData'

  /releases/history:
    get:
      summary: Returns a list of releases history.
      description: >
        Returns a list of releases history.
      tags:
        - "History Histories Releases"
      operationId: auslib.web.common.history_all.get_releases_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of releases history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
      responses:
        '200':
          description: Successfully fetched histories
        '400':
          $ref: '#/responses/invalidFormData'

  /permissions/history:
    get:
      summary: Returns a list of permissions history.
      description: >
        Returns a list of permissions history.
      tags:
        - "History Histories Permissions"
      operationId: auslib.web.common.history_all.get_permissions_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of rules, releases and permissions histories"
      parameters:
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
      responses:
        '200':
          description: Successfully fetched permissions history
        '400':
          $ref: '#/responses/invalidFormData'

  /rules_scheduled_change/history:
    get:
      summary: Returns a list of rules scheduled change history.
      description: >
        Returns rules scheduled change history.
      tags:
        - "History Rules Scheduled Change"
      operationId: auslib.web.common.history_all.get_rules_scheduled_change_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of rules scheduled change history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
      responses:
        '200':
          description: Successfully fetched rules scheduled change history
        '400':
          $ref: '#/responses/invalidFormData'

  /releases_scheduled_change/history:
    get:
      summary: Returns a list of releases scheduled change history.
      description: >
        Returns scheduled change histories.
      tags:
        - "History Releases Scheduled Change"
      operationId: auslib.web.common.history_all.get_releases_scheduled_change_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of releases scheduled change history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
      responses:
        '200':
          description: Successfully fetched releases scheduled change history
        '400':
          $ref: '#/responses/invalidFormData'

  /permissions_scheduled_change/history:
    get:
      summary: Returns a list of permissions scheduled change history.
      description: >
        Returns permissions scheduled change history.
      tags:
        - "History SC"
      operationId: auslib.web.common.history_all.get_permissions_scheduled_change_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of permissions scheduled changes history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
      responses:
        '200':
          description: Successfully fetched permissions scheduled changes history
        '400':
          $ref: '#/responses/invalidFormData'          

  /permission_required_signoffs_scheduled_change/history:
    get:
      summary: Returns a list of permissions required signoff scheduled change history.
      description: >
        Returns permissions required signoff scheduled change history.
      tags:
        - "History Permissions Scheduled Change Signoff"
      operationId: auslib.web.common.history_all.get_permission_required_signoffs_scheduled_change_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of permissions required signoff scheduled change history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
        - name: role
          in: query
          description: The role(s) required for permissions scheduled change
          type: string
          x-nullable: true
          required: false
      responses:
        '200':
          description: Successfully fetched permissions required signoff scheduled change history
        '400':
          $ref: '#/responses/invalidFormData'

  /product_required_signoffs_scheduled_change/history:
    get:
      summary: Returns a list of product required signoff scheduled change history.
      description: >
        Returns product required signoff scheduled change history.
      tags:
        - "History Product Signoff Scheduled Change"
      operationId: auslib.web.common.history_all.get_product_required_signoffs_scheduled_change_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of product required signoff scheduled change history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
        - name: channel
          in: query
          description: channel stirng for filtering history.
          type: string
          x-nullable: true
          required: false
        - name: role
          in: query
          description: The role(s) required product scheduled change
          type: string
          x-nullable: true
          required: false
      responses:
        '200':
          description: Successfully fetched product required signoff scheduled change history
        '400':
          $ref: '#/responses/invalidFormData'

  /history/diff/release/{change_id}/{field}:
    get:
      summary: Returns a diff of the value of the named field
      description: >
        Returns a diff of the value of the named field from the named object at the specified change_id vs the previous change to that object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#history-view-object-change-id-field)
      tags:
        - History
      operationId: auslib.web.admin.views.mapper.release_diff_history_get
      consumes: []
      produces:
        - application/json
        - text/plain
      externalDocs:
        description: "Returns a diff of the value of the named field from the named object at the specified change_id vs the previous change to that object"
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#history-view-object-change-id-field"
      parameters:
        - $ref: '#/parameters/change_id_param'
        - $ref: '#/parameters/field_name_param'
      responses:
        '200':
          description: Successfully fetched the requested diff value
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /history/view/release/{change_id}/{field}:
    get:
      summary: Returns the value of the named field from the named object at specified change_id
      description: >
        Returns the value of the named field from the named object at the specified change_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#history-view-object-change-id-field)
      tags:
        - History
      operationId: auslib.web.admin.views.mapper.release_view_history_get
      consumes: []
      produces:
        - application/json
        - text/plain
      externalDocs:
        description: "Returns the value of the named field from the named object at the specified change_id"
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#history-view-object-change-id-field"
      parameters:
        - $ref: '#/parameters/change_id_param'
        - $ref: '#/parameters/field_name_param'
      responses:
        '200':
          description: Successfully fetched the requested value
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /releases:
    get:
      summary: "Returns a JSON Object containing metadata about Releases in Balrog's database"
      description: >
        Returns a JSON object containing metadata about Releases in Balrog's database. Due to its size, the actual Release 'blob' is never returned from this endpoint. There are a few query arguments that affect its response. If no arguments are provided, it returns all information about all of the Releases in the database. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases"
        description: "Returns a JSON Object containing metadata about Releases in Balrog's database."
      parameters:
        - $ref: '#/parameters/productParam'
        - name: name_prefix
          in: query
          description: "If 'name_prefix' is passed, only Releases whose name starts with the given prefix will be returned."
          type: string
          x-nullable: true
          required: false
        - name: names_only
          in: query
          description: "If 'names_only' is set to true, the response changes format and provides a list of all of the Release names in the database"
          type: string
          x-nullable: true
          required: false
      responses:
        '200':
          description: Returns metadata about Releases
          schema:
            type: object
            # since there are two exclusive and independent data formats i.e. releases and names and
            # oneOf isn't supported in swagger 2.0 hence cannot have 'required'
            # field in schema
            properties:
              releases:
                description: list of release objects
                type: array
                minItems: 0
                items:
                  allOf:
                    - $ref: '#/definitions/ReleaseGET'
                    - properties:
                        required_signoffs:
                          description: Object mapping roles to the number of signoffs required to change the release
                          type: object

              names:
                description: List of release names
                type: array
                minItems: 0
                uniqueItems: true
                items:
                  type: string
                  maxLength: 100
          examples:
            application/json:
              releases:
                - data_version: 2
                  name: XP-Vista-Desupport
                  product: Firefox
                  read_only: false
                  rule_ids: [468, 498]

    post:
      summary: Creates a new Release
      description: >
        Creates a new Release with the provided values. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id9)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id9"
        description: "Creates a new Release in Balrog's DB."
      parameters:
        - name: release_body
          in: body
          description: New Release object data
          required: true
          schema:
            $ref: '#/definitions/ReleaseData'
      responses:
        '201':
          $ref: '#/responses/newObjectDataVersion'
        '400':
          $ref: '#/responses/invalidFormData'

  /releases/{release}:
    get:
      summary: "Returns the 'data' portion of the named Release, which is a JSON Object."
      description: >
        Returns the 'data' portion of the named Release, which is a JSON Object. If 'pretty' is present in the query string and set to true, it will be pretty formatted. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release)
      tags:
        - Releases
      operationId: auslib.web.common.releases.get_release_with_csrf_header
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release"
        description: "Returns the 'data' portion of the named Release, which is a JSON Object."
      parameters:
        - $ref: '#/parameters/releaseParam'
        - $ref: '#/parameters/pretty'
      responses:
        '200':
          $ref: '#/responses/releaseDataResponse'
        '404':
          $ref: '#/responses/resourceNotFound'

    put:
      summary: Overwrites the named Release with the data given.
      description: >
        Overwrites the named Release with the data given. The 'blob' field is completely overridden with the new one, not updated. If the Release does not exist, it is created. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.single_release_put
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Overwrites the named Release with the data given."
      parameters:
        - $ref: '#/parameters/releaseParam'
        - name: release_body
          in: body
          description: Release object data
          required: true
          schema:
            $ref: '#/definitions/ReleaseData'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '201':
          description: successfully created a new release
        '400':
          $ref: '#/responses/invalidFormData'
        '403':
          $ref: '#/responses/unauthorizedUser'

    post:
      summary: Updates the named Release with the data given.
      description: >
        Updates the named Release with the data given. The 'blob' field is updated with the new one instead of being completely overridden. If the Release does not exist, it is created. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id11)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.single_release_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id11"
        description: "Updates the named Release with the data given."
      parameters:
        - $ref: '#/parameters/releaseParam'
        - name: partial_release_body
          in: body
          description: Release object data
          required: true
          schema:
            $ref: '#/definitions/PartialRelease'
      responses:
        '200':
          $ref: '#/responses/modifiedDataVersion'
        '201':
          $ref: '#/responses/modifiedDataVersion'
        '400':
          $ref: '#/responses/invalidFormData'
        '403':
          $ref: '#/responses/unauthorizedUser'

    delete:
      summary: Deletes the named Release
      description: >
        Deletes the named Release. The 'data_version' parameter must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id12).
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.single_release_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id12"
        description: Deletes the named Release
      parameters:
        - $ref: '#/parameters/releaseParam'
        - $ref: '#/parameters/csrfTokenParam'
        - $ref: '#/parameters/dataVersionParam'
      responses:
        '200':
          description: Successfully deleted the release
        '403':
          $ref: '#/responses/unauthorizedUser'
        '404':
          $ref: '#/responses/resourceNotFound'

  /releases/{release}/read_only:
    get:
      summary: Returns whether or not the named Release is marked as read_only
      description: >
        Returns whether or not the named Release is marked as read_only. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-read-only)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_read_only_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-read-only"
        description: Returns whether or not the named Release is marked as read_only
      parameters:
        - $ref: '#/parameters/releaseParam'
      responses:
        '200':
          description: Returns release object data
          schema:
            type: object
            required:
              - read_only
            properties:
              read_only:
                description: boolean flag set to True is release is read only else set as False
                type: boolean
                example: true
        '404':
          $ref: '#/responses/resourceNotFound'

    put:
      summary: Sets or unsets the read_only flag of the named Release.
      description: >
        Sets or unsets the read_only flag of the named Release. Requires release name, data_version and read_only values. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id15)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_read_only_put
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id15"
        description: Sets or unsets the read_only flag of the named Release.
      parameters:
        - $ref: '#/parameters/releaseParam'
        - name: release_read_only_body
          in: body
          description: Read Only Release modify Request paramaters
          required: true
          schema:
            required:
              - data_version
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/DataVersionModel'
              - type: object
                description: read_only boolean flag
                required:
                  - read_only
                properties:
                  read_only:
                    # read_only key is always present when submitted from the UI form.
                    # In case of false , a blank string i.e. '' is passed as key's value
                    # hence we have to add type: string along with boolean as list of accepted types
                    # for read_only.
                    # TODO: Fix bug in UI and remove type: string below
                    type: ["boolean", "string"]
                    description: blank string if read only is true else set to false
                    example: true
                # TODO: Fix bug in UI. Currently the UI form sends the entire '#/definitions/ReleaseGET' model in
                # the request.json when only two values 'read_only' and 'data_version' are needed.
                additionalProperties: true
      responses:
        '201':
          $ref: '#/responses/updateExistingObject'
        '404':
          $ref: '#/responses/resourceNotFound'

  /releases/columns/{column}:
    get:
      summary: Returns a JSON Object containing the unique values for the given release column
      description: >
        Returns a JSON Object containing the unique values for the given column. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-columns-column)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_single_column_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-columns-column"
        description: "Returns a JSON Object containing the unique values for the given column."
      parameters:
        - $ref: '#/parameters/columnParam'
      responses:
        '200':
          $ref: '#/responses/columnResponse'
        '404':
          $ref: '#/responses/resourceNotFound'

  /releases/{release}/builds/{platform}/{locale}:
    get:
      summary: "Returns the platform+locale specific data of the named Release"
      description: >
        Returns the platform+locale specific data of the named Release, which is a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-builds-platform-locale)
      tags:
        - Releases
      operationId: auslib.web.common.releases.get_release_single_locale_with_csrf_header
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-builds-platform-locale"
        description: Returns the platform+locale specific data of the named Release
      parameters:
        - $ref: '#/parameters/releaseParam'
        - $ref: '#/parameters/platformParam'
        - $ref: '#/parameters/localeParam'
      responses:
        '200':
          $ref: '#/responses/releaseDataResponse'
        '404':
          $ref: '#/responses/resourceNotFound'

    put:
      summary: Updates the named Release with the data given.
      description: >
        Updates the named Release with the data given. The 'blob' field is updated with the new one instead of being completely overridden. If the Release does not exist, it is created. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id11)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_single_locale_view_put
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id11"
        description: "Updates the named Release with the data given."
      parameters:
        - $ref: '#/parameters/releaseParam'
        - $ref: '#/parameters/platformParam'
        - $ref: '#/parameters/localeParam'
        - name: partial_release_body
          in: body
          description: Release object data
          required: true
          schema:
            $ref: '#/definitions/PartialRelease'
      responses:
        '200':
          $ref: '#/responses/modifiedDataVersion'
        '201':
          $ref: '#/responses/modifiedDataVersion'
        '400':
          $ref: '#/responses/invalidFormData'
        '403':
          $ref: '#/responses/unauthorizedUser'

  /releases/{release}/revisions:
    get:
      summary: Returns previous versions of the named Release
      description: >
        Returns previous versions of the named Release in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-revisions)
      tags:
        - Releases
      operationId: auslib.web.common.releases.get_release_history
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-revisions"
        description: Returns previous versions of the named Release
      parameters:
        - $ref: '#/parameters/releaseParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of release revisions plus total count
          schema:
            type: object
            required:
              - revisions
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  revisions:
                    description: array where each element is a release revision object
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: "#/definitions/HistoryModel"
                        - $ref: '#/definitions/DataVersionModel'
                        - $ref: '#/definitions/ProductModel'
                        - $ref: '#/definitions/ReleaseName'
                        - type: object
                          properties:
                            read_only:
                              description: Flag that indicates whether release is marked read_only or not.
                              type: string
                              enum: [ "True", "False"]
                              example: "True"
                            _different:
                              description: list of columns that were modified in revision
                              type: array
                              uniqueItems: true
                              minItems: 0
                              items:
                                type: string
                              example: ["product", "data"]
                            _time_ago:
                              description: Time passed since the particular change
                              type: string
                              example: "1 day ago"
                      required:
                        - name
                        - product
                        - data_version
                        - read_only
                        - _different
                        - _time_ago
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    post:
      summary: Reverts the release to a previous revision
      description: >
        Reverts the named Release to the version identified by the change_id given in the request body. The request body must be a JSON object containing a 'change_id' key. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-revisions)
      tags:
        - Releases
      operationId: auslib.web.admin.views.mapper.release_history_view_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#releases-release-revisions"
        description: "Reverts the release to a previous revision."
      parameters:
        - $ref: '#/parameters/releaseParam'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the release revision
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /required_signoffs/product:
    get:
      summary: Returns all the product required signoffs
      description: >
        Endpoint to view all Product Required Signoffs. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#product-required-signoffs)
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_product_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#product-required-signoffs"
        description: Returns list of all product required signoffs.
      responses:
        '200':
          description: Returns JSON object of list of all product required signoffs plus total count
          schema:
            type: object
            required:
              - required_signoffs
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  required_signoffs:
                    description: array where each element is a product required signoff object
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: "#/definitions/ProductModel"
                        - $ref: "#/definitions/RoleModel"
                        - $ref: "#/definitions/ChannelModel"
                        - $ref: "#/definitions/SignoffsRequiredModel"
                        - $ref: "#/definitions/DataVersionModel"
                      required:
                        - product
                        - role
                        - channel
                        - data_version
                        - signoffs_required

    post:
      summary: Create a new Product Required Signoff.
      description: >
        Create a new Product Required Signoff. If the product and channel provided already require signoff, a 400 will be returned (you must use a Scheduled Change and meet the existing signoff requirements to modify Required Signoffs for things that already require it). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#required-signoffs-product)
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_product_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id30"
        description: "Create a new Product Required Signoff."
      parameters:
        - name: signoff
          in: body
          description: product required signoff json body request data
          required: true
          schema:
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/RoleModel'
              - $ref: '#/definitions/ChannelModel'
              - $ref: '#/definitions/SignoffsRequiredModel'
            required:
              - product
              - role
              - channel
              - signoffs_required
      responses:
        '201':
          $ref: '#/responses/newObjectDataVersion'
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Throws exception when attempt to revoke product signoff
      description: >
        Endpoint defined only to throw error when user attempts to delete product required signoff. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#product-required-signoffs).
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_product_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#product-required-signoffs"
        description: Throws exception when attempt to revoke product signoff
      responses:
        '400':
          $ref: '#/responses/invalidFormData'

  /required_signoffs/product/revisions:
    get:
      summary: Returns all the product required signoffs revisions
      description: >
        Endpoint to view revisions of Product Required Signoffs.Changes that directly affect updates that clients receive (the Rules and Releases tables) are considered Product changes. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#product-required-signoffs)
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_product_revisions_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#product-required-signoffs"
        description: Returns all the revisions of product required signoffs.
      parameters:
        - $ref: '#/parameters/productRequiredParam'
        - $ref: '#/parameters/roleRequiredParam'
        - $ref: '#/parameters/channelRequiredParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of product required signoffs plus total count
          schema:
            type: object
            required:
              - required_signoffs
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  required_signoffs:
                    description: array where each element is a product required signoffs revision object
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: "#/definitions/HistoryModel"
                        - $ref: "#/definitions/ProductModel"
                        - $ref: "#/definitions/RoleModel"
                        - $ref: "#/definitions/ChannelModel"
                        - $ref: "#/definitions/SignoffsRequiredModel"
                        - $ref: "#/definitions/DataVersionModel"
                      required:
                        - product
                        - role
                        - channel
                        - data_version
                        - signoffs_required
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /required_signoffs/product/history:
    get:
      summary: Returns a list of product required signoff history.
      description: >
        Returns product required signoff history.
      tags:
        - "History Signoff Product"
      operationId: auslib.web.common.history_all.get_product_required_signoffs_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of product required signoff history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
        - name: role
          in: query
          description: The role(s) required for product signoff
          type: string
          x-nullable: true
          required: false
      responses:
        '200':
          description: Successfully fetched product required signoff history
        '400':
          $ref: '#/responses/invalidFormData'

  /required_signoffs/permissions:
    get:
      summary: Returns all the permissions required signoffs
      description: >
        Endpoint to view all Permissions Required Signoffs. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#permissions-required-signoffs)
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_permissions_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#permissions-required-signoffs"
        description: Returns list of all permissions required signoffs.
      responses:
        '200':
          description: Returns JSON object of list of all permissions required signoffs plus total count
          schema:
            type: object
            required:
              - required_signoffs
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  required_signoffs:
                    description: array where each element is a permissions required signoff object
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: "#/definitions/ProductModel"
                        - $ref: "#/definitions/RoleModel"
                        - $ref: "#/definitions/SignoffsRequiredModel"
                        - $ref: "#/definitions/DataVersionModel"
                      required:
                        - product
                        - role
                        - data_version
                        - signoffs_required

    post:
      summary: Create a new Permission Required Signoff.
      description: >
        Create a new Permission Required Signoff. If the product provided already require signoff, a 400 will be returned (you must use a Scheduled Change and meet the existing signoff requirements to modify Required Signoffs for things that already require it). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#permissions-required-signoffs)
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_permissions_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#permissions-required-signoffs"
        description: "Create a new Permission Required Signoff."
      parameters:
        - name: signoff
          in: body
          description: permission required signoff json body request data
          required: true
          schema:
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/RoleModel'
              - $ref: '#/definitions/SignoffsRequiredModel'
            required:
              - product
              - role
              - signoffs_required
      responses:
        '201':
          $ref: '#/responses/newObjectDataVersion'
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Throws exception when attempt to revoke permissions signoff
      description: >
        Endpoint defined only to throw error when user attempts to delete permissions required signoff. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#permissions-required-signoffs).
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_permissions_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#permissions-required-signoffs"
        description: Throws exception when attempt to revoke permissions signoff
      responses:
        '400':
          $ref: '#/responses/invalidFormData'

  /required_signoffs/permissions/revisions:
    get:
      summary: Returns all the permissions required signoffs revisions
      description: >
        Endpoint to view revisions of Permissions Required Signoffs. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#permissions-required-signoffs)
      tags:
        - Required Signoffs
      operationId: auslib.web.admin.views.mapper.required_signoffs_permissions_revisions_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#permissions-required-signoffs"
        description: Returns all the revisions of permissions required signoffs.
      parameters:
        - $ref: '#/parameters/productRequiredParam'
        - $ref: '#/parameters/roleRequiredParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of permissions required signoffs plus total count
          schema:
            type: object
            required:
              - required_signoffs
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  required_signoffs:
                    description: array where each element is a permissions required signoffs revision object
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: "#/definitions/HistoryModel"
                        - $ref: "#/definitions/ProductModel"
                        - $ref: "#/definitions/RoleModel"
                        - $ref: "#/definitions/DataVersionModel"
                        - $ref: "#/definitions/SignoffsRequiredModel"
                      required:
                        - product
                        - role
                        - data_version
                        - signoffs_required
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /required_signoffs/permissions/history:
    get:
      summary: Returns a list of permissions required signoff history.
      description: >
        Returns permissions required signoff history.
      tags:
        - "History Permissions Signoff"
      operationId: auslib.web.common.history_all.get_permission_required_signoffs_history
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#put"
        description: "Returns a list of permissions required signoff history"
      parameters:
        - $ref: '#/parameters/productParam'
        - $ref: '#/parameters/limitParam'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/changedByParam'
        - $ref: '#/parameters/changeIdParam'
        - $ref: '#/parameters/historyDataVersionParam'
        - $ref: '#/parameters/timestampFromParam'
        - $ref: '#/parameters/timestampToParam'
        - name: role
          in: query
          description: The role(s) required for permission signoff
          type: string
          x-nullable: true
          required: false
      responses:
        '200':
          description: Successfully fetched permissions required signoff history
        '400':
          $ref: '#/responses/invalidFormData'

  /users:
    get:
      summary: Returns all of Users in Balrog's DB
      description: >
        Returns all of the usernames present in Balrog. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id20)
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.users_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id19"
        description: "Returns all of Users in Balrog's DB."
      responses:
        '200':
          description: Get all Users and their Roles
          schema:
            type: object
            properties:
              users:
                description: list of users
                type: array
                uniqueItems: true
                minItems: 0
                items:
                  type: object
                example: {
                  "balrogadmin": {
                    "roles":[
                      {
                        "data_version": 1,
                        "role": "releng"
                      },
                      {
                        "data_version": 1,
                        "role": "relman"
                      }]
                  }
                }


  /users/{username}:
    get:
      summary: Returns all of the details about the user
      description: >
        Returns all of the details about the user's roles and permissions [Docs](http://mozilla-balrog.readthedocs.io/en/latest/database.html#permissions).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.specific_user_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#user-roles"
        description: Returns all of the details about the user
      parameters:
        - $ref: '#/parameters/usernameParam'
      responses:
        '200':
          description: Successfully fetched all user details.
          schema:
            type: object
            required:
              - username
              - permissions
              - roles
            properties:
              username:
                description: unique identifier name of the user
                type: string
                maxLength: 100
                minLength: 1
                example: balrogadmin
              roles:
                description: "user's assigned roles"
                type: object
                # Cannot fully validate roles object as patternProperties, part of jsonschema, isn't supported by
                # swagger. https://github.com/OAI/OpenAPI-Specification/issues/687
                example:
                  sample_role:
                    data_version: 1
              permissions:
                $ref: "#/definitions/UserPermissionsGET"
          examples:
            application/json:
              permissions:
                rule:
                  data_version: 1
                  options:
                    actions:
                      - create
                      - modify
              roles:
                temp:
                  data_version: 1
              username: balrogadmin
        '404':
          $ref: '#/responses/resourceNotFound'
        '403':
          $ref: '#/responses/unauthorizedUser'


  /users/{username}/permissions:
    get:
      summary: Returns all of the details about the user
      description: >
        Returns all of the details about the user's permissions [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-permissions).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_permissions_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id21"
        description: Returns all of the details about the user's permissions
      parameters:
        - $ref: '#/parameters/usernameParam'
      responses:
        '200':
          description: Successfully fetched all permission details
          schema:
            $ref: "#/definitions/UserPermissionsGET"
          examples:
            application/json:
              rule:
                data_version: 2
                options:
                  actions: ['create', 'modify']


  /users/{username}/roles/{role}:
    put:
      summary: Grants the given username the given role
      description: >
        Grants the given username the given role. If the user already holds that role, this is a no-op. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-roles-role).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_role_put
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id27"
        description: Grants the given username the given role
      parameters:
        - $ref: '#/parameters/usernameParam'
        - $ref: '#/parameters/roleParam'
      responses:
        '200':
          $ref: '#/responses/modifiedDataVersion'
        '201':
          $ref: '#/responses/newObjectDataVersion'
    delete:
      summary: Revokes the given role from the given username
      description: >
        Revokes the given role from the given username. The 'data_version' parameter must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-roles-role).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_role_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id28"
        description: Revokes the given role from the given username
      parameters:
        - $ref: '#/parameters/usernameParam'
        - $ref: '#/parameters/roleParam'
        - $ref: '#/parameters/csrfTokenParam'
        - $ref: '#/parameters/dataVersionParam'
      responses:
        '200':
          description: Successfully revoked the user role
        '404':
          $ref: '#/responses/resourceNotFound'

  /users/{username}/permissions/{permission}:
    get:
      summary: Returns the details of the named permission
      description: >
        Returns the details of the named permission for the username given in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-permissions-permission).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_specific_permission_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id22"
        description: Returns the details of the named permission
      parameters:
        - $ref: '#/parameters/usernameParam'
        - $ref: '#/parameters/permissionParam'
      responses:
        '200':
          description: Successfully fetched the details of the given permission
          schema:
            $ref: "#/definitions/UserPermissionsModel"
          examples:
            application/json:
              data_version: 1
              options:
                actions:
                  - create
                  - modify
        '404':
          $ref: '#/responses/resourceNotFound'

    put:
      summary: Overwrites or creates the details of named permission for the username given.
      description: >
        Overwrites the details of named permission for the username given. If the permission does not exist, it is created. The following parameters are supported , data_version (required if the permission already exists) and options, a JSON string field [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-permissions-permission).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_specific_permission_put
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id23"
        description: Overwrites the options of named permission for the username given.If the permission does not exist, it is created first.
      parameters:
        - $ref: '#/parameters/usernameParam'
        - $ref: '#/parameters/permissionParam'
        - $ref: '#/parameters/userPermissionFormDataParam'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '201':
          $ref: '#/responses/newObjectDataVersion'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Only overwrites the details of named permission for the username given.
      description: >
        Overwrites the details of named permission for the username given. The following parameters are supported , data_version(required) and options, a JSON string field [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-permissions-permission).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_specific_permission_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id23"
        description: Overwrites the options of named permission for the username given.
      parameters:
        - $ref: '#/parameters/usernameParam'
        - $ref: '#/parameters/permissionParam'
        - $ref: '#/parameters/userPermissionFormDataParam'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the named permission for the username given.
      description: >
        Deletes the named permission for the username given. data_version is required. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#users-username-permissions-permission).
      tags:
        - Users
      operationId: auslib.web.admin.views.mapper.user_specific_permission_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id28"
        description: "Deletes the named permission for the username given. The 'data_version' parameter must be provided."
      parameters:
        - $ref: '#/parameters/usernameParam'
        - $ref: '#/parameters/permissionParam'
        - $ref: '#/parameters/csrfTokenParam'
        - $ref: '#/parameters/dataVersionParam'
      responses:
        '200':
          description: Successfully deleted the permission
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /rules:
    get:
      summary: Returns filtered list of Rules from Balrog's DB
      description: >
        Returns filtered list Rules in Balrog’s database inside of a JSON Object. Returns all rules if 'product' query parameter isn't passed. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id1)
      tags:
        - Rules
      operationId: auslib.web.common.rules.get_rules
      consumes: []
      produces: [application/json]
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id1"
        description: "Returns filtered list of Rules from Balrog's DB."
      parameters:
        - $ref: '#/parameters/productParam'

      responses:
        '200':
          description: Get json object of list all Rules with their count
          schema:
            $ref: '#/definitions/RulesListGET'

    post:
      summary: creates a new Rule in Balrog's DB
      description: >
        Creates a new Rule in Balrog's database. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#post)
      tags:
        - Rules
      operationId: auslib.web.admin.views.mapper.rules_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id1"
        description: "creates a new Rule in Balrog's DB."
      parameters:
        - name: rule
          in: body
          description: New Rule object data
          required: true
          schema:
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/UpdateType'
              - $ref: '#/definitions/RulesBase'
            #If you change the required list order or add extra fields, make sure to modify this endpoint's test cases plus code for handling /scheduled_changes/rules/  POST operation endpoint.
            required:
              - update_type
              - backgroundRate
              - priority
      responses:
        '200':
          description: Successfully created a new rule
          schema:
            title: successfully created a new rule
            type: integer
            example: 514
          examples:
            text/html: 514
        '400':
          $ref: '#/responses/invalidFormData'

  /rules/{id_or_alias}:
    get:
      summary: Returns a rule identified by the id or alias
      description: >
        Returns the entire rule identified by the id or alias given in JSON format. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#rules-id-or-alias)
      tags:
        - Rules
      operationId: auslib.web.common.rules.get_rule_with_csrf_headers
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id2"
        description: "Returns the entire rule identified by the id or alias given in JSON format."
      parameters:
        - $ref: '#/parameters/rule_id_or_alias_param'
      responses:
        '200':
          description: Successfully fetched a rule
          schema:
            $ref: "#/definitions/RuleObject"
          headers:
            X-Data-Version:
              description: data version of the rule
              type: integer
              format: int32
              minimum: 1
        '404':
          $ref: '#/responses/resourceNotFound'

    post:
      summary: Updates the rule
      description: >
        Updates the rule identified by the id or alias. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id3)
      tags:
        - Rules
      operationId: auslib.web.admin.views.mapper.rules_id_or_alias_post
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id2"
        description: "Returns the entire rule identified by the id or alias given in JSON format."
      parameters:
        - $ref: '#/parameters/rule_id_or_alias_param'
        - name: rule
          in: body
          description: Rule object data
          required: true
          schema:
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/RulesBase'
              - $ref: '#/definitions/RulesNonNullable'
            required:
              - data_version
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    # Exactly same as POST
    put:
      summary: Updates the rule
      description: >
        Updates the rule identified by the id or alias. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id3)
      tags:
        - Rules
      operationId: auslib.web.admin.views.mapper.rules_id_or_alias_put
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id2"
        description: "Returns the entire rule identified by the id or alias given in JSON format."
      parameters:
        - $ref: '#/parameters/rule_id_or_alias_param'
        - name: rule
          in: body
          description: Rule object data
          required: true
          schema:
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/RulesBase'
              - $ref: '#/definitions/RulesNonNullable'
            required:
              - data_version
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Deletes a rule identified by the rule id
      description: >
        Deletes the entire rule entry in DB identified by the rule_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#delete)
      tags:
        - Rules
      operationId: auslib.web.admin.views.mapper.rules_id_or_alias_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#delete"
        description: "Deletes the rule identified by the rule_id."
      parameters:
        - $ref: '#/parameters/rule_id_or_alias_param'
        - $ref: '#/parameters/csrfTokenParam'
        - $ref: '#/parameters/dataVersionParam'
      responses:
        '200':
          description: Successfully deleted a rule
        '404':
          $ref: '#/responses/resourceNotFound'

  /rules/{rule_id}/revisions:
    get:
      summary: Fetches all revisions of a Rule
      description: Fetches list and count of all the revisions of the rule given by rule_id
      tags:
        - Rules
      operationId: auslib.web.common.rules.get_rule_history
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#rules"
        description: "Fetches list and count of all the revisions of the rule given by rule_id"
      parameters:
        - $ref: '#/parameters/rule_id_param'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of rules with their count
          schema:
            type: object
            allOf:
              - $ref: "#/definitions/RulesListGET"
              - type: object
                properties:
                  rules:
                    description: array where each element is a rule object plus timestamp, change_id and changed_by
                    type: array
                    items:
                      $ref: '#/definitions/HistoryModel'
          examples:
            application/json:
              count: 1
              rules:
                - alias: "esr45-localtest"
                  backgroundRate: 100
                  buildID: null
                  buildTarget: null
                  channel: "esr-localtest"
                  comment: "esr45 esr-localtest rule"
                  changed_by: "balrogadmin"
                  change_id: 10
                  timestamp: 149530544
                  data_version: 22
                  distVersion: null
                  distribution: null
                  fallbackMapping: null
                  headerArchitecture: null
                  instructionSet: null
                  jaws: null
                  locale: null
                  mapping: "Firefox-45.7.0esr-build1"
                  memory: null
                  mig64: null
                  osVersion: null
                  priority: 43
                  product: "Firefox"
                  rule_id: 308
                  update_type: "minor"
                  version: null
                  whitelist: null
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Reverts the rule to a previous revision
      description: >
        Updates the rule identified by the rule_id to a previous revision identified by change_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#history-view-object-change-id-field)
      tags:
        - Rules
      operationId: auslib.web.admin.views.mapper.rules_revisions_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#history-view-object-change-id-field"
        description: "Updates the rule identified by the rule_id to a previous revision identified by change_id."
      parameters:
        - $ref: '#/parameters/rule_id_param'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the Rule
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /rules/columns/{column}:
    get:
      summary: Returns a JSON Object containing the unique values for the given column.
      description: >
        Returns a JSON Object containing the unique values for the given Rule column. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#rules-columns-column)
      tags:
        - Rules
      operationId: auslib.web.admin.views.mapper.single_rule_column_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id6"
        description: "Returns a JSON Object containing the unique values for the given Rule column."
      parameters:
        - $ref: '#/parameters/columnParam'
      responses:
        '200':
          $ref: '#/responses/columnResponse'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/rules:
    get:
      summary: Returns scheduled changes for rules.
      description: >
        Endpoint to get Scheduled Changes for Rules. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_rules_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: Returns scheduled changes for rules.
      parameters:
        - $ref: '#/parameters/allSCParam'
      responses:
        '200':
          description: Returns JSON object of list of all scheduled changes for rules plus total count
          schema:
            type: object
            required:
              - scheduled_changes
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  scheduled_changes:
                    description: array where each element is a scheduled change for a Rule
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCSignoffsModel'
                        - $ref: '#/definitions/SCRulesItemBase'
                        - properties:
                            original_row:
                              $ref: '#/definitions/RuleObject'
    post:
      summary: create scheduled change for rules.
      description: >
        Create scheduled change for a rule(existing or new). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id34)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_rules_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: "create scheduled change for rule."
      parameters:
        - name: change_type
          in: query
          description: "'change_type' value for a scheduled change."
          type: string
          enum:
            - insert
            - delete
            - update
          minLength: 1
          maxLength: 20
          x-nullable: true
          required: false
        - name: sc_rule_body
          in: body
          description: request body for sc rule
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCChangeType'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCUptake'
              - $ref: '#/definitions/RulesSCNullable'
              - $ref: '#/definitions/RulesBase'
      responses:
        '200':
          description: Returns sc_id of change
          schema:
            $ref: '#/definitions/SCIdModel'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/rules/{sc_id}:
    post:
      summary: Modifies existing scheduled change for a Rule.
      description: >
        Modifies existing scheduled change for a rule. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_rules_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: "Modifies existing scheduled change for a Rule."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - name: sc_rule_body
          in: body
          description: request body for editing sc rule
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCChangeType'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCUptake'
              - $ref: '#/definitions/SCDataVersion'
              - $ref: '#/definitions/RulesSCNullable'
              - $ref: '#/definitions/RulesBase'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the given Scheduled Change for the Rule.
      description: >
        Deletes the given Scheduled Change for the named Rule object. 'data_version' must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_rules_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: Deletes the given Scheduled Change for the Rule.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/dataVersionParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/rules/{sc_id}/revisions:
    get:
      summary: Returns previous versions of the scheduled change
      description: >
        Returns previous versions of the scheduled change identified by the sc_id given in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_rules_history_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Returns previous versions of the scheduled change identified by the sc_id"
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of sc rules along with their count
          schema:
            type: object
            required:
              - revisions
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  revisions:
                    description: array where each element is a SC Rule object
                    type: array
                    minItems: 0
                    items:
                      allOf:
                        - $ref: "#/definitions/SCRulesItemBase"
                        - $ref: '#/definitions/HistoryModel'
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Reverts to any previous version of scheduled change
      description: >
        Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_rules_history_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the scheduled change object
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/permissions:
    get:
      summary: Returns scheduled changes for permissions.
      description: >
        Endpoint to get Scheduled Changes for Permissions. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_permissions_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: Returns scheduled changes for permissions.
      parameters:
        - $ref: '#/parameters/allSCParam'
      responses:
        '200':
          description: Returns JSON object of list of all scheduled changes for permissions plus total count
          schema:
            type: object
            required:
              - scheduled_changes
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  scheduled_changes:
                    description: array where each element is a scheduled change for a Permission.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCSignoffsModel'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/OptionsModel'
                        - $ref: '#/definitions/PermissionsModel'
                        - properties:
                            original_row:
                              allOf:
                                - $ref: '#/definitions/DataVersionNullable'
                                - $ref: '#/definitions/PermissionsModel'
                                - $ref: '#/definitions/OptionsModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - permission
                        - username
    post:
      summary: create scheduled change for permissions.
      description: >
        Create scheduled change for a permission(existing or new). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id34)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_permissions_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: "create scheduled change for permissions."
      parameters:
        - name: sc_permission_body
          in: body
          description: request body for sc permission
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCChangeType'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/DataVersionNullable'
              - $ref: '#/definitions/PermissionsModel'
              - $ref: '#/definitions/OptionsJSON'
            required:
              - change_type
              - permission
              - username
              - when
      responses:
        '200':
          description: Returns sc_id of change
          schema:
            $ref: '#/definitions/SCIdModel'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/permissions/{sc_id}:
    post:
      summary: Modifies existing scheduled change for a Permission.
      description: >
        Modifies existing scheduled change for a permission. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: "Modifies existing scheduled change for a Permission."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - name: sc_permission_body
          in: body
          description: request body for editing sc permission
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCDataVersion'
              - $ref: "#/definitions/DataVersionNullable"
              - $ref: '#/definitions/OptionsJSON'
              - $ref: '#/definitions/PermissionsModel'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the given Scheduled Change for the Permission.
      description: >
        Deletes the given Scheduled Change for the named Permission object. 'data_version' must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: Deletes the given Scheduled Change for the Permission.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/dataVersionParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/permissions/{sc_id}/revisions:
    get:
      summary: Returns previous versions of the scheduled change
      description: >
        Returns previous versions of the scheduled change identified by the sc_id given in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_history_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Returns previous versions of the scheduled change identified by the sc_id"
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of sc permissions along with their count
          schema:
            type: object
            required:
              - revisions
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  revisions:
                    description: array where each element is a scheduled change for a SC Permission.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: "#/definitions/DataVersionNullable"
                        - $ref: '#/definitions/OptionsModel'
                        - $ref: '#/definitions/PermissionsModel'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/HistoryModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - permission
                        - username
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Reverts to any previous version of scheduled change
      description: >
        Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_history_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the scheduled change object
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/releases:
    get:
      summary: Returns scheduled changes for releases.
      description: >
        Endpoint to get Scheduled Changes for Releases. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_releases_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: Returns scheduled changes for releases.
      parameters:
        - $ref: '#/parameters/allSCParam'
      responses:
        '200':
          description: Returns JSON object of list of all scheduled changes for releases plus total count
          schema:
            type: object
            required:
              - scheduled_changes
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  scheduled_changes:
                    description: array where each element is a scheduled change for a Release.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCSignoffsModel'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/ProductNullable'
                        - $ref: '#/definitions/ReleaseReadOnly'
                        - $ref: '#/definitions/ReleaseDataObject'
                        - $ref: '#/definitions/ReleaseName'
                        - properties:
                            original_row:
                              allOf:
                                - $ref: '#/definitions/ReleaseDataObject'
                                - $ref: '#/definitions/ReleaseName'
                                - $ref: '#/definitions/DataVersionNullable'
                                - $ref: '#/definitions/ProductNullable'
                                - $ref: '#/definitions/ReleaseReadOnly'
                      required:
                        - change_type
                        - data_version
                        - when
                        - product
                        - name
                        - data
                        - read_only
    post:
      summary: create scheduled change for a release.
      description: >
        Create scheduled change for a release(existing or new). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id34)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_releases_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: "create scheduled change for releases."
      parameters:
        - name: sc_release_body
          in: body
          description: request body for sc release
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCChangeType'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/DataVersionModel'
              - $ref: '#/definitions/ReleaseDataField'
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/ReleaseName'
            required:
              - change_type
              - name
              - when
      responses:
        '200':
          description: Returns sc_id of change
          schema:
            $ref: '#/definitions/SCIdModel'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/releases/{sc_id}:
    post:
      summary: Modifies existing scheduled change for a Release.
      description: >
        Modifies existing scheduled change for a release. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_releases_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: "Modifies existing scheduled change for a Release."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - name: sc_release_body
          in: body
          description: request body for editing sc release
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCDataVersion'
              - $ref: "#/definitions/DataVersionNullable"
              - $ref: '#/definitions/ReleaseDataField'
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/ReleaseName'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the given Scheduled Change for the Release.
      description: >
        Deletes the given Scheduled Change for the named Release object. 'data_version' must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_releases_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: Deletes the given Scheduled Change for the Release.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/dataVersionParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/releases/{sc_id}/revisions:
    get:
      summary: Returns previous versions of the scheduled change
      description: >
        Returns previous versions of the scheduled change identified by the sc_id given in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_releases_history_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Returns previous versions of the scheduled change identified by the sc_id"
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of sc releases along with their count
          schema:
            type: object
            required:
              - revisions
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  revisions:
                    description: array where each element is a scheduled change for a SC Release.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/ProductNullable'
                        - $ref: '#/definitions/ReleaseReadOnly'
                        - $ref: '#/definitions/ReleaseDataObject'
                        - $ref: '#/definitions/ReleaseName'
                        - $ref: '#/definitions/HistoryModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - product
                        - name
                        - data
                        - read_only
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Reverts to any previous version of scheduled change
      description: >
        Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_releases_history_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the scheduled change object
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/required_signoffs/product:
    get:
      summary: Returns scheduled changes for required signoffs of Products.
      description: >
        Endpoint to get Scheduled Changes for required signoffs of products. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_rs_product_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: Returns scheduled changes for required signoffs of products.
      parameters:
        - $ref: '#/parameters/allSCParam'
      responses:
        '200':
          description: Returns JSON object of list of all scheduled changes for required signoffs of products plus total count
          schema:
            type: object
            required:
              - scheduled_changes
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  scheduled_changes:
                    description: array where each element is a scheduled change for a Product Required Signoff.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCSignoffsModel'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/SignoffsRequiredNullable'
                        - $ref: '#/definitions/ProductModel'
                        - $ref: '#/definitions/RoleModel'
                        - $ref: '#/definitions/ChannelModel'
                        - properties:
                            original_row:
                              allOf:
                                - $ref: '#/definitions/DataVersionNullable'
                                - $ref: '#/definitions/SignoffsRequiredNullable'
                                - $ref: '#/definitions/ProductModel'
                                - $ref: '#/definitions/RoleModel'
                                - $ref: '#/definitions/ChannelModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - product
                        - channel
                        - role
                        - signoffs_required
    post:
      summary: create scheduled change for required signoffs of Product.
      description: >
        Create scheduled change for required signoffs of product(existing or new). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id34)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_rs_product_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: "create scheduled change for required signoffs of product."
      parameters:
        - name: sc_rs_product_body
          in: body
          description: request body for sc required signoffs of product
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCChangeType'
              - $ref: '#/definitions/SCTime'
              # TODO: UI passes data_version as 'null' for change_type == 'insert'. It shouldn't pass it at all in request body. Fix it and change the below model to 'DataVersionModel'
              - $ref: '#/definitions/DataVersionNullable'
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/RoleModel'
              - $ref: '#/definitions/ChannelModel'
              - $ref: '#/definitions/SignoffsRequiredModel'
            required:
              - change_type
              - product
              - channel
              - role
              - when
      responses:
        '200':
          description: Returns sc_id of change
          schema:
            $ref: '#/definitions/SCIdModel'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/required_signoffs/product/{sc_id}:
    post:
      summary: Modifies existing scheduled change for a Product Required Signoff.
      description: >
        Modifies existing scheduled change for a Product Required Signoff. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_product_rs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: "Modifies existing scheduled change for a Product Required Signoff."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - name: sc_product_rs_body
          in: body
          description: request body for editing sc product required signoff
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCDataVersion'
              - $ref: "#/definitions/DataVersionNullable"
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/RoleModel'
              - $ref: '#/definitions/ChannelModel'
              - $ref: '#/definitions/SignoffsRequiredModel'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the given Scheduled Change for the Product Required Signoff.
      description: >
        Deletes the given Scheduled Change for the named Product Required Signoff object. 'data_version' must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_product_rs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: Deletes the given Scheduled Change for the Product Required Signoff.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/dataVersionParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/required_signoffs/product/{sc_id}/revisions:
    get:
      summary: Returns previous versions of the scheduled change
      description: >
        Returns previous versions of the scheduled change identified by the sc_id given in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_product_rs_history_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Returns previous versions of the scheduled change identified by the sc_id"
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of sc product required signoffs along with their count
          schema:
            type: object
            required:
              - revisions
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  revisions:
                    description: array where each element is a scheduled change for an sc product required signoffs.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/SignoffsRequiredNullable'
                        - $ref: '#/definitions/ProductModel'
                        - $ref: '#/definitions/RoleModel'
                        - $ref: '#/definitions/ChannelModel'
                        - $ref: '#/definitions/HistoryModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - product
                        - channel
                        - role
                        - signoffs_required
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Reverts to any previous version of scheduled change
      description: >
        Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_product_rs_history_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the scheduled change object
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/required_signoffs/permissions:
    get:
      summary: Returns scheduled changes for required signoffs of Permissions.
      description: >
        Endpoint to get Scheduled Changes for required signoffs of permissions. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_rs_permissions_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: Returns scheduled changes for required signoffs of permissions.
      parameters:
        - $ref: '#/parameters/allSCParam'
      responses:
        '200':
          description: Returns JSON object of list of all scheduled changes for required signoffs of permissions plus total count
          schema:
            type: object
            required:
              - scheduled_changes
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  scheduled_changes:
                    description: array where each element is a scheduled change for a Permission Required Signoff.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCSignoffsModel'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/SignoffsRequiredNullable'
                        - $ref: '#/definitions/ProductModel'
                        - $ref: '#/definitions/RoleModel'
                        - properties:
                            original_row:
                              allOf:
                                - $ref: '#/definitions/DataVersionNullable'
                                - $ref: '#/definitions/SignoffsRequiredNullable'
                                - $ref: '#/definitions/ProductModel'
                                - $ref: '#/definitions/RoleModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - product
                        - role
                        - signoffs_required
    post:
      summary: create scheduled change for required signoffs of Permission.
      description: >
        Create scheduled change for required signoffs of product(existing or new). [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id34)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_changes_rs_permissions_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/database.html#scheduled-changes"
        description: "create scheduled change for required signoffs of permissions."
      parameters:
        - name: sc_rs_permission_body
          in: body
          description: request body for sc required signoffs of permissions
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCChangeType'
              - $ref: '#/definitions/SCTime'
              # TODO: UI passes data_version as 'null' for change_type == 'insert'. It shouldn't pass it at all in request body. Fix it and change the below model to 'DataVersionModel'
              - $ref: '#/definitions/DataVersionNullable'
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/RoleModel'
              - $ref: '#/definitions/SignoffsRequiredModel'
            required:
              - change_type
              - product
              - role
              - when
      responses:
        '200':
          description: Returns sc_id of change
          schema:
            $ref: '#/definitions/SCIdModel'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/required_signoffs/permissions/{sc_id}:
    post:
      summary: Modifies existing scheduled change for a Permission Required Signoff.
      description: >
        Modifies existing scheduled change for a Permission Required Signoff. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_rs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: "Modifies existing scheduled change for a Permission Required Signoff."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - name: sc_permission_rs_body
          in: body
          description: request body for editing sc permission required signoff
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCDataVersion'
              - $ref: "#/definitions/DataVersionNullable"
              - $ref: '#/definitions/ProductModel'
              - $ref: '#/definitions/RoleModel'
              - $ref: '#/definitions/SignoffsRequiredModel'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the given Scheduled Change for the Permission Required Signoff.
      description: >
        Deletes the given Scheduled Change for the named Permission Required Signoff object. 'data_version' must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_rs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: Deletes the given Scheduled Change for the Permission Required Signoff.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/dataVersionParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/required_signoffs/permissions/{sc_id}/revisions:
    get:
      summary: Returns previous versions of the scheduled change
      description: >
        Returns previous versions of the scheduled change identified by the sc_id given in a JSON Object. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_rs_history_get
      consumes: []
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Returns previous versions of the scheduled change identified by the sc_id"
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/pageParam'
        - $ref: '#/parameters/limitParam'
      responses:
        '200':
          description: Returns JSON object of list of revisions of sc permission required signoffs along with their count
          schema:
            type: object
            required:
              - revisions
            allOf:
              - $ref: '#/definitions/CountModel'
              - type: object
                properties:
                  revisions:
                    description: array where each element is a scheduled change for an sc permission required signoffs.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCChangeType'
                        - $ref: '#/definitions/SCTime'
                        - $ref: '#/definitions/SCIdModel'
                        - $ref: '#/definitions/SCDataVersion'
                        - $ref: '#/definitions/SCCommonFieldsModel'
                        - $ref: '#/definitions/DataVersionNullable'
                        - $ref: '#/definitions/SignoffsRequiredNullable'
                        - $ref: '#/definitions/ProductModel'
                        - $ref: '#/definitions/RoleModel'
                        - $ref: '#/definitions/HistoryModel'
                      required:
                        - change_type
                        - data_version
                        - when
                        - product
                        - role
                        - signoffs_required
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

    post:
      summary: Reverts to any previous version of scheduled change
      description: >
        Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_rs_history_post
      consumes:
        - application/json
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-id-revisions"
        description: "Reverts the scheduled change identified by the given sc_id to the version identified by the change_id given in the request body."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/change_id_body_param'
      responses:
        '200':
          description: Successfully reverted back the scheduled change object
        '404':
          $ref: '#/responses/resourceNotFound'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/rules/{sc_id}/enact:
    post:
      summary: Execute the scheduled change for the rule.
      description: >
        Execute the scheduled change for the rule identified by the sc_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.enact_scheduled_change_rules_post
      consumes: []
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact"
        description: "Execute the scheduled change for the rule."
      parameters:
        - $ref: '#/parameters/sc_id_param'
      responses:
        '200':
          description: Successfully enacted the scheduled change

  /scheduled_changes/permissions/{sc_id}/enact:
    post:
      summary: Execute the scheduled change for the permission.
      description: >
        Execute the scheduled change for the permission identified by the sc_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.enact_scheduled_change_permissions_post
      consumes: []
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact"
        description: "Execute the scheduled change for the permission."
      parameters:
        - $ref: '#/parameters/sc_id_param'
      responses:
        '200':
          description: Successfully enacted the scheduled change

  /scheduled_changes/releases/{sc_id}/enact:
    post:
      summary: Execute the scheduled change for the release.
      description: >
        Execute the scheduled change for the release identified by the sc_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.enact_scheduled_change_releases_post
      consumes: []
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact"
        description: "Execute the scheduled change for the release."
      parameters:
        - $ref: '#/parameters/sc_id_param'
      responses:
        '200':
          description: Successfully enacted the scheduled change

  /scheduled_changes/required_signoffs/product/{sc_id}/enact:
    post:
      summary: Execute the scheduled change for the required signoffs for product.
      description: >
        Execute the scheduled change for the required signoffs for product identified by the sc_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.enact_scheduled_change_product_rs_post
      consumes: []
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact"
        description: "Execute the scheduled change for the required signoffs for product."
      parameters:
        - $ref: '#/parameters/sc_id_param'
      responses:
        '200':
          description: Successfully enacted the scheduled change

  /scheduled_changes/required_signoffs/permissions/{sc_id}/enact:
    post:
      summary: Execute the scheduled change for the required signoffs for permission.
      description: >
        Execute the scheduled change for the required signoffs for permission identified by the sc_id. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.enact_scheduled_change_permissions_rs_post
      consumes: []
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-enact"
        description: "Execute the scheduled change for the required signoffs for permission."
      parameters:
        - $ref: '#/parameters/sc_id_param'
      responses:
        '200':
          description: Successfully enacted the scheduled change

  /scheduled_changes/rules/{sc_id}/signoffs:
    post:
      summary: Signs off on the given Scheduled Change for Rule.
      description: >
        Signs off on the given Scheduled Change for Rule. 'role' must be provided in the request body.[Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_rules_signoffs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: "Signs off on the given Scheduled Change for Rule."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/sc_signoff_post_body_param'
      responses:
        '200':
          description: Successfully signed off on the given scheduled change for the named object.
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Removes an existing Signoff from the Scheduled Change for the Rule.
      description: >
        Removes an existing Signoff from the Scheduled Change for the Rule. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_rules_signoffs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: Removes an existing Signoff from the Scheduled Change for the Rule.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/usernameQueryParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the signoff on the given scheduled change.
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/permissions/{sc_id}/signoffs:
    post:
      summary: Signs off on the given Scheduled Change for Permission.
      description: >
        Signs off on the given Scheduled Change for Permission. 'role' must be provided in the request body.[Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_signoffs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: "Signs off on the given Scheduled Change for Permission."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/sc_signoff_post_body_param'
      responses:
        '200':
          description: Successfully signed off on the given scheduled change for the named object.
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Removes an existing Signoff from the Scheduled Change for the Permission.
      description: >
        Removes an existing Signoff from the Scheduled Change for the Permission. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_signoffs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: Removes an existing Signoff from the Scheduled Change for the Permission.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/usernameQueryParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the signoff on the given scheduled change.
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/releases/{sc_id}/signoffs:
    post:
      summary: Signs off on the given Scheduled Change for Release.
      description: >
        Signs off on the given Scheduled Change for Release. 'role' must be provided in the request body.[Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_release_signoffs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: "Signs off on the given Scheduled Change for Release."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/sc_signoff_post_body_param'
      responses:
        '200':
          description: Successfully signed off on the given scheduled change for the named object.
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Removes an existing Signoff from the Scheduled Change for the Release.
      description: >
        Removes an existing Signoff from the Scheduled Change for the Release. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_release_signoffs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: Removes an existing Signoff from the Scheduled Change for the Release.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/usernameQueryParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the signoff on the given scheduled change.
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/required_signoffs/product/{sc_id}/signoffs:
    post:
      summary: Signs off on the given Scheduled Change for Product Required Signoff.
      description: >
        Signs off on the given Scheduled Change for Product Required Signoff. 'role' must be provided in the request body.[Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_product_rs_signoffs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: "Signs off on the given Scheduled Change for Product Required Signoff."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/sc_signoff_post_body_param'
      responses:
        '200':
          description: Successfully signed off on the given scheduled change for the named object.
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Removes an existing Signoff from the Scheduled Change for the Product Required Signoff.
      description: >
        Removes an existing Signoff from the Scheduled Change for the Product Required Signoff. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_product_rs_signoffs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: Removes an existing Signoff from the Scheduled Change for the Product Required Signoff.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/usernameQueryParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the signoff on the given scheduled change.
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/required_signoffs/permissions/{sc_id}/signoffs:
    post:
      summary: Signs off on the given Scheduled Change for Permission Required Signoff.
      description: >
        Signs off on the given Scheduled Change for Permission Required Signoff. 'role' must be provided in the request body.[Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_rs_signoffs_post
      consumes:
        - application/json
      produces:
        - text/html
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: "Signs off on the given Scheduled Change for Permission Required Signoff."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/sc_signoff_post_body_param'
      responses:
        '200':
          description: Successfully signed off on the given scheduled change for the named object.
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Removes an existing Signoff from the Scheduled Change for the Permission Required Signoff.
      description: >
        Removes an existing Signoff from the Scheduled Change for the Permission Required Signoff. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs)
      tags:
        - Scheduled Changes
      operationId: auslib.web.admin.views.mapper.scheduled_change_permissions_rs_signoffs_delete
      consumes: []
      produces:
        - application/json
        - text/html
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id-signoffs"
        description: Removes an existing Signoff from the Scheduled Change for the Permission Required Signoff.
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/usernameQueryParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the signoff on the given scheduled change.
        '404':
          $ref: '#/responses/resourceNotFound'

  /emergency_shutoff:
    get:
      summary: List of emergency shut off.
      description: >
        Products/Channels that updates are disabled.
      tags:
        - Emergency Shutoff
      operationId: auslib.web.common.emergency_shutoff.get
      produces:
        - application/json
      responses:
        '200':
          description: Emergency shut off list.
          schema:
            $ref: '#/definitions/EmergencyShutoffListGET'

    post:
      summary: Creates an emergency shut off.
      description: Creates an emergency shut off for given product/channel.
      tags:
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.post
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: emergency_shutoff
          in: body
          description: Emergency shut off data.
          schema:
            allOf:
              - $ref: '#/definitions/EmergencyShutOffModel'
      responses:
        '201':
          description: Successfully created an emergency shut off.
        '400':
          $ref: '#/responses/invalidFormData'

  /emergency_shutoff/{product}/{channel}:
    get:
      summary: Emergency shut off.
      description: >
        Get emergency shut off by Id.
      tags:
        - Emergency Shutoff
      operationId: auslib.web.common.emergency_shutoff.get_by_id
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/productPathParam'
        - $ref: '#/parameters/channelPathParam'
      responses:
        '200':
          description: Shut off information.
          schema:
            $ref: "#/definitions/EmergencyShutOffModel"
          headers:
            X-Data-Version:
              description: data version of the shut off
              type: integer
              format: int32
              minimum: 1
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes an emergency shut off.
      description: Deletes an emergency shut off.
      tags:
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.delete
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/productPathParam'
        - $ref: '#/parameters/channelPathParam'
        - $ref: '#/parameters/csrfTokenParam'
        - $ref: '#/parameters/dataVersionParam'
      responses:
        '200':
          description: Successfully deleted the shut off.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/emergency_shutoff:
    get:
      summary: Returns scheduled changes for emergency shut off.
      description: >
        Returns changes that was automatically scheduled when updates for a product/channel was disabled.
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.scheduled_changes
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/allSCParam'
      responses:
        '200':
          description: JSON object with scheduled changes for emergency shut off.
          schema:
            type: object
            required:
              - scheduled_changes
            allOf:
              - $ref: "#/definitions/CountModel"
              - type: object
                properties:
                  scheduled_changes:
                    description: Array where each element is a scheduled change for a emergency shut off.
                    type: array
                    minItems: 0
                    items:
                      type: object
                      allOf:
                        - $ref: '#/definitions/SCSignoffsModel'
                        - $ref: '#/definitions/EmergencyShutOffModel'
                        - properties:
                            original_row:
                              $ref: '#/definitions/EmergencyShutOffModel'

    post:
      summary: Create scheduled change for emergency shut off.
      description: >
        Create scheduled change for a emergency shut off. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#id34)
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.schedule_deletion
      consumes:
        - application/json
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object"
        description: "create scheduled change for emergency shut off."
      parameters:
        - name: sc_emergency_shutoff
          in: body
          description: Request body for sc emergency shut off
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/EmergencyShutOffModel'
            properties:
              change_type:
                description: type of change
                type: string
                enum:
                  - delete
                minLength: 1
                maxLength: 50
                example: update
      responses:
        '200':
          description: Returns sc_id of change
          schema:
            $ref: '#/definitions/SCIdModel'
        '400':
          $ref: '#/responses/invalidFormData'

  /scheduled_changes/emergency_shutoff/{sc_id}:
    post:
      summary: Modifies existing scheduled change for a Emergency shut off.
      description: >
        Modifies existing scheduled change for a Emergency shut off. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.update_scheduled_deletion
      consumes:
        - application/json
      produces:
        - application/json
      externalDocs:
        url: "http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id"
        description: "Modifies existing scheduled change for a Emergency shut off."
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - name: sc_emergency_shutoff
          in: body
          description: Request body for editing sc Emergency shut off.
          required: true
          schema:
            type: object
            allOf:
              - $ref: '#/definitions/CSRFModel'
              - $ref: '#/definitions/SCTime'
              - $ref: '#/definitions/SCDataVersion'
      responses:
        '200':
          $ref: '#/responses/updateExistingObject'
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

    delete:
      summary: Deletes the given Scheduled Change for Emergency Shutoff.
      description: >
        Deletes the given Scheduled Change for Emergency Shutoff. 'data_version' must be provided. [Docs](http://mozilla-balrog.readthedocs.io/en/latest/admin_api.html#scheduled-changes-object-sc-id)
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.delete_scheduled_deletion
      consumes: []
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/dataVersionParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'
        '404':
          $ref: '#/responses/resourceNotFound'

  /scheduled_changes/emergency_shutoff/{sc_id}/enact:
    post:
      summary: Execute the scheduled change for the emergency shut off.
      description: >
        Execute the scheduled change for the emergency shut off and reenables the updates for the product/channel.
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.enact_updates_scheduled_for_reactivation
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/sc_id_param'
      responses:
        '200':
          description: Successfully enacted the scheduled change.

  /scheduled_changes/emergency_shutoff/{sc_id}/signoffs:
    post:
      summary: Signs off on the given emergency shut off.
      description: Signs off on the given emergency shut off.
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.scheduled_changes_signoffs
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/sc_signoff_post_body_param'
      responses:
        '200':
          description: Successfully signed off on the given scheduled change.
        '400':
          $ref: '#/responses/invalidFormData'

    delete:
      summary: Removes an existing Signoff from the emergency shut off Scheduled Change.
      description: Removes an existing Signoff from the emergency shut off Scheduled Change.
      tags:
        - Scheduled Changes
        - Emergency Shutoff
      operationId: auslib.web.admin.emergency_shutoff.scheduled_changes_signoffs_delete
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/sc_id_param'
        - $ref: '#/parameters/usernameQueryParam'
        - $ref: '#/parameters/csrfTokenParam'
      responses:
        '200':
          description: Successfully deleted the signoff on the given scheduled change.
        '404':
          $ref: '#/responses/resourceNotFound'

definitions:
  CSRFModel:
    title: CSRF Token
    description: CSRF Token in POST/PUT or UPDATE requests
    type: object
    required:
      - csrf_token
    properties:
      csrf_token:
        type: string
        example: "1491342563##c4e6fef0b978e6c89af9ff1015e67b9ca7c45d14"

  DataVersionNullable:
    title: Nullable Data Version
    description: "model to re-use nullable 'data_version' field for scheduled_changes"
    type: object
    properties:
      data_version:
        description: the version number of object
        type: ["integer", "null"]
        format: data_version
        example: 1

  SCIdModel:
    title: SC ID
    description: "model to re-use 'sc_id' field"
    type: object
    required:
      - sc_id
    properties:
      sc_id:
        description: id of scheduled change
        type: integer
        format: int32
        minimum: 0
        example: 2

  SignoffsRequiredModel:
    title: Signoffs Required
    description: "model to re-use 'signoffs_required' integer field."
    type: object
    properties:
      signoffs_required:
        description: The number of signoffs required for a given role
        type: ["integer", "string"]
        format: signoffs_required
        example: 2

  SignoffsRequiredNullable:
    title: Signoffs Required Nullable
    description: "model to re-use 'signoffs_required' nullable integer field."
    type: object
    properties:
      signoffs_required:
        description: The number of signoffs required for a given role
        type: ["integer", "string", "null"]
        format: signoffs_required
        example: 2

  RoleModel:
    title: User Role
    description: "model to re-use 'role' field."
    type: object
    properties:
      role:
        description: roles are used when signing off on Scheduled Changes
        type: string
        minLength: 1
        maxLength: 50
        example: releng

  ProductNullable:
    title: Product Nullable
    description: "model to define nullable 'product' field in request/response JSON body"
    type: object
    properties:
      product:
        description: The product name that the client must send in order for the rule to match. Only full string matches are supported.
        type: ["string", "null"]
        minLength: 1
        maxLength: 15
        example: Firefox

  PermissionsModel:
    title: Permissions
    description: User Permissions JSON field model.
    type: object
    properties:
      permission:
        description: Permission name
        type: string
        minLength: 1
        maxLength: 50
        enum:
          - admin
          - rule
          - release
          - release_read_only
          - release_locale
          - required_signoff
          - permission
          - scheduled_change
        example: admin
      username:
        description: user name
        type: string
        minLength: 1
        maxLength: 100
        example: balrogadmin

  SCDataVersion:
    title: SC Data Version
    description: "model for re-using sc_data_version field"
    type: object
    required:
      - sc_data_version
    properties:
      sc_data_version:
          type: integer
          description: version number of scheduled change
          format: int32
          minimum: 1
          example: 2

  SCCommonFieldsModel:
    title: SC Common Fields
    description: "model for defining and re-using miscellaneous common fields in scheduled changes GET operations"
    type: object
    required:
      - complete
      - scheduled_by
    properties:
      complete:
        type: boolean
        description: is Scheduled change complete
        example: false
      scheduled_by:
        type: string
        description: user who scheduled the change
        minLength: 1
        maxLength: 100
        example: balrogadmin

  SCSignoffsModel:
    title: SC GET
    description: "model for defining signoffs fields in scheduled changes GET operations"
    type: object
    required:
      - required_signoffs
      - signoffs
    properties:
      required_signoffs:
        type: object
        description: Contains key-value pairs of role names and number of minimum signoffs needed from each role
        example:
          releng: 2
      signoffs:
        type: object
        description: Contains key-value pairs of user name and role name via which the change was signed off
        example:
          releng: 2

  SCUptake:
    title: Schedule Change Uptake
    description: scheduled change telemtry parameters
    type: object
    properties:
      telemetry_product:
        description: Name of telemetry product
        type: ["string", "null"]
        minLength: 1
        maxLength: 15
      telemetry_channel:
        description: Name of telemetry channel
        type: ["string", "null"]
        minLength: 1
        maxLength: 75
      telemetry_uptake:
        description: number of telemetry uptakes.
        type: ["integer", "string", "null"]
        format: telemetry_uptake
        example: 1

  SCTime:
    title: Schedule Change Time
    description: "model to re-use 'when' field in  scheduled change."
    type: object
    properties:
      when:
        description: Time (in milliseconds since epoch) when to enact scheduled change
        type: ["integer", "null"]
        format: when
        example: 1499712894

  SCChangeType:
    title: SC Change Type
    description: "Scheduled change 'change_type' field"
    type: object
    properties:
      change_type:
        description: type of change
        type: string
        enum:
          - insert
          - update
          - delete
        minLength: 1
        maxLength: 50
        example: update

  ReleaseData:
    title: Release form values plus blob
    description: "Release Base Model + release blob"
    type: object
    allOf:
      - $ref: "#/definitions/CSRFModel"
      - $ref: '#/definitions/DataVersionModel'
      - $ref: '#/definitions/ProductModel'
      - $ref: '#/definitions/ReleaseName'
      - type: object
        properties:
          blob:
            type: string
            example: '{"hashFunction": "sha512", "name": "CDM-979", "product": "Firefox", "schema_version": 1000, "vendors": { "gmp-eme-adobe": { "platforms": {"WINNT_x86_64-msvc-x64": {"alias": "WINNT_x86_64-msvc"}},"version": "15"}}}'
            format: JSONStringField
            description: json blob containing information about the release
    required:
      - name
      - product
      - blob

  ReleaseDataObject:
    title: Release Data object
    description: "release's blob data fetched as json object"
    type: object
    properties:
      data:
        description: json blob containing information about the release
        type: ["object", "null"]
        example:
          hashFunction: sha512
          name: CDM-15
          product: Firefox
          schema_version: 1000
          vendors:
            gmp-eme-adobe:
              platforms:
                WINNT_x86_64-msvc-x64:
                  alias: WINNT_x86_64-msvc
              version: '15'

  ReleaseDataField:
    title: Release Data field
    description: "release's json blob data as marshalled as string"
    type: object
    properties:
      data:
        description: json blob containing information about the release marshalled as string
        type: string
        format: JSONStringField
        example: '{"hashFunction": "sha512", "name": "CDM-979", "product": "Firefox", "schema_version": 1000, "vendors": { "gmp-eme-adobe": { "platforms": {"WINNT_x86_64-msvc-x64": {"alias": "WINNT_x86_64-msvc"}},"version": "15"}}}'

  PartialRelease:
    title: Partial Release
    description: "Partial Release form values"
    type: object
    allOf:
      # Note: 'name' is inherited with other required fields from Base model but never used when processing the input request
      - $ref: '#/definitions/CSRFModel'
      - $ref: '#/definitions/DataVersionModel'
      - $ref: '#/definitions/ProductModel'
      - $ref: '#/definitions/ReleaseName'
      - $ref: '#/definitions/ReleaseDataField'
      - type: object
        properties:
          hashFunction:
            description: cryptographic hash function to assure integrity of transmitted data
            type: string
            example: sha512
          schema_version:
            description: The version number of release
            type: integer
            format: int32
            minimum: 1
            example: 1
          copyTo:
            description: List names of releases which the updated data must be copied to
            type: string
            format: JSONStringField
          alias:
            description: id of the release
            type: string
            format: JSONStringField
    required:
      - product
      - data

  OptionsJSON:
    title: Option JSONStringfield
    description: "model to re-use 'options' string field in user permissions"
    type: object
    properties:
      options:
        type: ["string", "null"]
        format: JSONStringField
        description: JSON field specifying the actions that user can perform and the prdouct on which it has current permission to do so
        example: "{'actions':['modify']}"

  OptionsModel:
    title: Options object
    description: "Data model for permission's options field"
    type: object
    properties:
      options:
        type: ['object', 'null']
        description: Options available for the given permission
        properties:
          products:
            type: array
            uniqueItems: true
            items:
              type: string
            example: ["Firefox"]
          actions:
            type: array
            uniqueItems: true
            items:
              type: string
            example: ["modify"]

  UserPermissionsModel:
    title: User Permissions
    description: "Model of user's permissions with all details of avaliable options and actions for the rule,release,required signoff and permission of user is assigned"
    type: object
    allOf:
      - $ref: "#/definitions/DataVersionModel"
      - $ref: "#/definitions/OptionsModel"
    required:
      - data_version

  UserPermissionsGET:
    title: GET User Permissions
    description: Model which defines all possible user permission objects and their actions and options
    type: object
    properties:
      # Each key is a permission object
      admin:
        description: "An admin user with no options specified has completely unrestricted access to Balrog"
        allOf:
          - $ref: "#/definitions/DataVersionModel"
          - type: object
            properties:
              options:
                type: ['object', 'null']
                description: Options available for admin permission
                properties:
                  products:
                    description: If specified, the user can perform any actions on Rules or Releases that affect the specified products
                    type: array
                    uniqueItems: true
                    items:
                      type: string

        required:
          - data_version
      release:
        description: "Release permission to perform actions on releases. Example actions: add create, delete or modify release of products"
        $ref: "#/definitions/UserPermissionsModel"

      rule:
        description: "Rule permission to perform actions. Example actions: add create, delete or modify rules of products"
        $ref: "#/definitions/UserPermissionsModel"

      required_signoff:
        description: "Permission to perform actions related to required signoffs. Example: add create, delete or modify rules of products"
        $ref: "#/definitions/UserPermissionsModel"

      release_locale:
        description: "Release Locale permission to perform modify action only on product releases."
        $ref: "#/definitions/UserPermissionsModel"

      release_read_only:
        description: "Read only Releases permission to perform modify action only on product releases."
        $ref: "#/definitions/UserPermissionsModel"

      permission:
        description: "permission to perform modify actions only."
        allOf:
          - $ref: "#/definitions/DataVersionModel"
          - type: object
            properties:
              options:
                type: ['object', 'null']
                description: Options available for the given permission
                properties:
                  actions:
                    type: array
                    uniqueItems: true
                    items:
                      type: string
        required:
          - data_version

      scheduled_change:
        description: "permission to schedule a change to rule, release or permission. Only the Balrog Agent should be granted this permission."
        allOf:
          - $ref: "#/definitions/DataVersionModel"
          - type: object
            properties:
              options:
                type: ['object', 'null']
                description: Options available for the given permission
                properties:
                  actions:
                    type: array
                    uniqueItems: true
                    items:
                      type: string
        required:
          - data_version

  SCRulesItemBase:
    title: SC Rules Base Model
    description: defines base model for operations on SC Rules
    type: object
    allOf:
      - $ref: '#/definitions/SCChangeType'
      - $ref: '#/definitions/SCTime'
      - $ref: '#/definitions/SCUptake'
      - $ref: '#/definitions/SCIdModel'
      - $ref: '#/definitions/RulesBase'
      - $ref: '#/definitions/RulesSCNullable'
      - $ref: '#/definitions/SCDataVersion'
      - $ref: '#/definitions/SCCommonFieldsModel'
    required:
      - alias
      - backgroundRate
      - buildID
      - buildTarget
      - change_type
      - channel
      - comment
      - data_version
      - distVersion
      - distribution
      - fallbackMapping
      - headerArchitecture
      - instructionSet
      - jaws
      - locale
      - mapping
      - memory
      - mig64
      - osVersion
      - priority
      - product
      - rule_id
      - telemetry_channel
      - telemetry_product
      - telemetry_uptake
      - update_type
      - version
      - when

  RulesSCNullable:
    title: Rule nullable fields
    description: Balrog's Rule Attributes that can have null values in scheduled changes tables
    type: object
    properties:
      rule_id:
        description: "The id of the rule. This id (or the rule's alias, if set) is necessary to make changes to the rule through the REST API."
        type: ["integer", "string", "null"]
        format: rule_id
        readOnly: true
        example: 10

      data_version:
        description: the version number of rule
        type: ["integer", "string", "null"]
        format: data_version
        example: 1

      update_type:
        description: "The update_type to use in the XML response. 'minor' is almost always the correct value these days."
        type: ["string", "null"]
        minLength: 0
        maxLength: 15
        enum: [ "major", "minor", null]
        example: minor

    #Warning: Do NOT add an example object here. Interferes with Example Value during
    # request generation in Swagger-UI
